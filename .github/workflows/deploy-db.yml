name: Deploy Database Migrations

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Setup Supabase CLI
        uses: supabase/setup-cli@v1
        with:
          version: latest

      - name: Push Database Migrations
        # 注意：这里直接把你的敏感信息写在了脚本里
        run: |
          supabase link --project-ref exbymqyakzxibltikwum --password 'z5RgI7gs9av95AEj'
          supabase db push --password 'X3LK4m3IjhkRTNrr'
        env:
          # 只有这个 Token 建议保留在环境变量格式，或者你也直接写死
          SUPABASE_ACCESS_TOKEN: 'sbp_29719731f42aa788eacad8977134082253678719'
